<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PayKaro – Secure UPI Payment</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Inter,Segoe UI,Arial}
body{
  min-height:100vh;
  background:radial-gradient(circle at top,#0f6bdc,#071b34 70%);
  display:flex;align-items:center;justify-content:center;
}
.card{
  background:#fff;
  width:92%;max-width:420px;
  padding:28px;
  border-radius:26px;
  box-shadow:0 40px 80px rgba(0,0,0,.35);
  text-align:center;
}
.logo{
  font-size:22px;
  font-weight:900;
  color:#0e5cad;
  margin-bottom:6px;
}
.sub{
  font-size:12px;
  color:#666;
  margin-bottom:18px;
}
h2{
  font-size:22px;
  color:#0f2a44;
  margin-bottom:10px;
}
input{
  width:100%;
  padding:13px;
  margin-top:10px;
  border-radius:14px;
  border:1px solid #ccd6e3;
  font-size:14px;
}
button{
  width:100%;
  padding:16px;
  margin-top:16px;
  border:none;
  border-radius:999px;
  font-weight:800;
  font-size:15px;
  cursor:pointer;
}
.primary{
  background:linear-gradient(90deg,#0e5cad,#1f86ff);
  color:#fff;
}
.secondary{
  background:#f1f5fb;
  color:#0e5cad;
}
.amount{
  font-size:26px;
  font-weight:900;
  color:#0e5cad;
  margin:12px 0;
}
.note{
  font-size:12px;
  color:#666;
  margin-top:12px;
}
.link-box{
  background:#f4f8fd;
  padding:12px;
  border-radius:12px;
  word-break:break-all;
  font-size:13px;
  margin-top:10px;
}
.qrBox img{
  width:200px;
  margin:14px auto;
}
.hide{display:none}
</style>
</head>

<body>

<!-- ================= CREATE PAYMENT LINK ================= -->
<div class="card" id="create">
  <div class="logo">PayKaro</div>
  <div class="sub">Create a simple UPI payment page</div>

  <input id="topic" placeholder="Product / Service name">
  <input id="datetime" type="datetime-local">
  <input id="amount" type="number" placeholder="Amount (₹)">
  <input id="upi" placeholder="UPI ID (name@bank)">
  <input id="group" placeholder="WhatsApp Group Link (optional)">

  <button class="primary" onclick="generateLink()">Generate Payment Link</button>

  <div id="out" class="hide">
    <div class="note">Share this payment link</div>
    <div class="link-box" id="finalLink"></div>
    <button class="secondary" onclick="copyLink()">Copy Link</button>
  </div>
</div>

<!-- ================= BUYER PAYMENT PAGE ================= -->
<div class="card hide" id="pay">
  <div class="logo">PayKaro</div>

  <h2 id="pTitle"></h2>
  <div class="note" id="pDate"></div>
  <div class="amount">₹<span id="pAmount"></span></div>

  <button class="primary" onclick="payNow()">Pay via UPI</button>

  <!-- Desktop QR -->
  <div class="qrBox hide" id="qrBox">
    <div class="note"><b>Scan & Pay (Desktop)</b></div>
    <img id="qrImg">
    <div class="note" id="upiText"></div>
  </div>

  <!-- Access after payment -->
  <button id="accessBtn" class="secondary hide" onclick="goToGroup()">
    Access WhatsApp Group
  </button>

  <div class="note">
    After completing payment in your UPI app,<br>
    return here to access the group.
  </div>
</div>

<script>
/* ===== CREATE LINK ===== */
function generateLink(){
  const t = encodeURIComponent(topic.value);
  const d = encodeURIComponent(datetime.value);
  const a = amount.value;
  const u = upi.value.trim();
  const g = encodeURIComponent(group.value.trim());

  const url =
    `${location.origin}${location.pathname}`+
    `?t=${t}&d=${d}&a=${a}&u=${u}&g=${g}`;

  finalLink.innerText = url;
  out.classList.remove("hide");
}

function copyLink(){
  navigator.clipboard.writeText(finalLink.innerText);
  alert("Payment link copied");
}

/* ===== LOAD PAYMENT PAGE ===== */
const q = new URLSearchParams(location.search);
if(q.get("t")){
  create.classList.add("hide");
  pay.classList.remove("hide");

  const title = decodeURIComponent(q.get("t"));
  const date = decodeURIComponent(q.get("d"));
  const amt  = q.get("a");
  const upiId = q.get("u");

  pTitle.innerText = title;
  pDate.innerText = date;
  pAmount.innerText = amt;

  // Desktop → QR
  if(!/Android|iPhone|iPad/i.test(navigator.userAgent)){
    qrBox.classList.remove("hide");
    qrImg.src =
      "https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=" +
      encodeURIComponent(`upi://pay?pa=${upiId}&pn=PayKaro&am=${amt}&cu=INR`);
    upiText.innerText = upiId;
    accessBtn.classList.remove("hide");
  }
}

/* ===== PAY ===== */
function payNow(){
  const upiId = q.get("u");
  const amt = q.get("a");

  const intent =
    `upi://pay?pa=${upiId}&pn=PayKaro&am=${amt}&cu=INR`;

  if(/Android|iPhone|iPad/i.test(navigator.userAgent)){
    window.location.href = intent;
    setTimeout(()=>{
      accessBtn.classList.remove("hide");
    },4000);
  } else {
    qrBox.classList.remove("hide");
    accessBtn.classList.remove("hide");
  }
}

/* ===== ACCESS ===== */
function goToGroup(){
  const g = q.get("g");
  if(g){
    window.location.href = decodeURIComponent(g);
  } else {
    alert("Group link not provided by seller");
  }
}
</script>

</body>
</html>
