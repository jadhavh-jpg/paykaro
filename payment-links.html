<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PayKaro â€“ Secure Payment</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Inter,Segoe UI,Arial}
body{
  min-height:100vh;
  background:radial-gradient(circle at top,#0e5cad,#071b34 70%);
  display:flex;align-items:center;justify-content:center;
}
.card{
  background:#ffffff;
  width:92%;max-width:420px;
  padding:26px;
  border-radius:26px;
  box-shadow:0 40px 80px rgba(0,0,0,.35);
  text-align:center;
}
.logo{
  font-size:20px;
  font-weight:800;
  color:#0e5cad;
  margin-bottom:8px;
}
h2{font-size:22px;color:#0f2a44;margin-bottom:10px}
input{
  width:100%;padding:12px;margin-top:8px;
  border-radius:14px;border:1px solid #ccd6e3;
}
button{
  width:100%;padding:15px;margin-top:16px;
  border:none;border-radius:999px;
  font-weight:700;font-size:15px;cursor:pointer;
}
.primary{
  background:linear-gradient(90deg,#0e5cad,#1f86ff);
  color:#fff;
}
.secondary{
  background:#f1f5fb;
  color:#0e5cad;
}
.qrBox img{width:180px;margin-top:12px}
.note{font-size:12px;color:#666;margin-top:10px}
.hide{display:none}
</style>
</head>

<body>

<!-- CREATE PAGE -->
<div class="card" id="create">
  <div class="logo">PayKaro</div>
  <h2>Create Payment Page</h2>

  <input id="topic" placeholder="Product / Service Name">
  <input id="datetime" type="datetime-local">
  <input id="amount" type="number" placeholder="Amount (â‚¹)">
  <input id="upi" placeholder="UPI ID (name@bank)">
  <input id="wa" placeholder="WhatsApp Number (91XXXXXXXXXX)">
  <label class="note">Optional: Upload your QR code</label>
  <input type="file" id="qrUpload" accept="image/*">

  <button class="primary" onclick="generate()">Generate & Pay</button>

  <div id="out" class="hide">
    <p class="note">Share this payment link</p>
    <p id="finalLink" style="word-break:break-all;font-size:13px"></p>
    <button class="secondary" onclick="copyLink()">Copy Link</button>
  </div>
</div>

<!-- LANDING PAGE -->
<div class="card hide" id="landing">
  <div class="logo">PayKaro</div>
  <h2 id="lTopic"></h2>
  <p><b>Date:</b> <span id="lDate"></span></p>
  <p style="font-size:22px;font-weight:800;color:#0e5cad">â‚¹<span id="lAmount"></span></p>

  <button class="primary" onclick="payNow()">Pay Now</button>

  <!-- QR -->
  <div class="qrBox hide" id="qrBox">
    <p class="note"><b>Scan & Pay</b></p>
    <img id="qrImg">
  </div>

  <button class="secondary hide" id="afterPay" onclick="afterPayment()">
    Continue
  </button>

  <p class="note">
    After completing payment in your UPI app, return here and tap Continue.
  </p>
</div>

<script>
let uploadedQR = "";

document.getElementById("qrUpload").addEventListener("change", e=>{
  const file = e.target.files[0];
  if(file){
    uploadedQR = URL.createObjectURL(file);
  }
});

function generate(){
  const t=encodeURIComponent(topic.value);
  const d=encodeURIComponent(datetime.value);
  const a=amount.value;
  const u=upi.value.trim();
  const w=wa.value.trim();

  const url =
    `${location.origin}${location.pathname}?t=${t}&d=${d}&a=${a}&u=${u}&w=${w}`;

  finalLink.innerText=url;
  out.classList.remove("hide");

  // ðŸ“± Mobile: auto open payment
  if(/Android|iPhone/i.test(navigator.userAgent)){
    window.location.href =
      `upi://pay?pa=${u}&pn=PayKaro&am=${a}&cu=INR`;
  }
}

function copyLink(){
  navigator.clipboard.writeText(finalLink.innerText);
  alert("Payment link copied");
}

// Landing
const q=new URLSearchParams(location.search);
if(q.get("t")){
  create.classList.add("hide");
  landing.classList.remove("hide");

  lTopic.innerText=decodeURIComponent(q.get("t"));
  lDate.innerText=decodeURIComponent(q.get("d"));
  lAmount.innerText=q.get("a");

  const upi=q.get("u");
  const amt=q.get("a");

  // Desktop QR
  if(!/Android|iPhone/i.test(navigator.userAgent)){
    qrBox.classList.remove("hide");
    qrImg.src = uploadedQR ||
      `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=`+
      encodeURIComponent(`upi://pay?pa=${upi}&pn=PayKaro&am=${amt}&cu=INR`);
  }
}

function payNow(){
  document.getElementById("afterPay").classList.remove("hide");
  window.location.href =
    `upi://pay?pa=${q.get("u")}&pn=PayKaro&am=${q.get("a")}&cu=INR`;
}

function afterPayment(){
  const w=q.get("w");
  if(w){
    window.location.href =
      `https://wa.me/${w}?text=Thank%20you%20for%20your%20payment.%20If%20paid%20successfully,%20please%20reply%20DONE.`;
  }
}
</script>

</body>
</html>
